<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Abalone Age Prediction Project</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background: #f4f7f9;
            color: #333;
        }
        h1, h2, h3 {
            color: #444;
            text-align: center;
            padding-top: 10px;
        }
        h1 {
            border-bottom: 2px solid #e8491d;
            padding-bottom: 10px;
        }
        h2 {
            margin-top: 40px;
            border-bottom: 1px solid #ccc;
            padding-bottom: 5px;
        }
        pre {
            background: #fff;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow-x: auto;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .code {
            background: #fff;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow-x: auto;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .container {
            max-width: 900px;
            margin: 20px auto;
            background: #fff;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .results {
            margin-top: 20px;
            background: #eef;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .results ul {
            list-style: none;
            padding: 0;
        }
        .results ul li {
            padding: 10px 0;
        }
        .results ul li:not(:last-child) {
            border-bottom: 1px solid #ddd;
        }
        .images {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        .images img {
            max-width: 100%;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        footer {
            text-align: center;
            padding: 20px 0;
            margin-top: 20px;
            border-top: 1px solid #ddd;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Abalone Age Prediction Project</h1>
        <p>This project involves predicting the age of abalone from physical measurements using various regression models. Below are the steps followed, along with the results of the model comparisons.</p>

        <h2>Step 1: Load the Data</h2>
        <pre class="code">
import pandas as pd

# Load the dataset
file_path = 'path_to_your_abalone_dataset.csv'
df = pd.read_csv(file_path, header=None)

# Add column names
df.columns = ['Sex', 'Length', 'Diameter', 'Height', 'Whole_weight', 'Shucked_weight', 'Viscera_weight', 'Shell_weight', 'Rings']

# Print the initial DataFrame
print("Initial DataFrame with Correct Column Names:")
print(df.head())
        </pre>

        <h2>Step 2: Convert the Sex Column to Numerical Values</h2>
        <pre class="code">
# One-hot encoding for the 'Sex' column
df = pd.get_dummies(df, columns=['Sex'], drop_first=True)

# Add 'Age' column
df['Age'] = df['Rings'] + 1.5

# Drop the 'Rings' column
df.drop(columns=['Rings'], inplace=True)

# Print the modified DataFrame
print("DataFrame with Sex Columns as Integers:")
print(df.head())
        </pre>

        <h2>Step 3: Exploratory Data Analysis (EDA)</h2>
        <pre class="code">
import matplotlib.pyplot as plt
import seaborn as sns

# Plot histograms of the features
df.hist(bins=30, figsize=(20, 15))
plt.show()

# Plot pairplot
sns.pairplot(df)
plt.show()
        </pre>

        <h2>Correlation Analysis</h2>
        <pre class="code">
# Compute the correlation matrix
correlation_matrix = df.corr()

# Plot the heatmap
plt.figure(figsize=(12, 8))
sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm')
plt.show()
        </pre>

        <h2>Step 4: Data Preprocessing</h2>
        <pre class="code">
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler

# Split the data into features and target
X = df.drop(columns=['Age'])
y = df['Age']

# Split the data into training and testing sets
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Standardize the features
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)
X_test_scaled = scaler.transform(X_test)

# Print the shape of the datasets
print(f"Shape of X_train: {X_train.shape}")
print(f"Shape of y_train: {y_train.shape}")
print(f"Shape of X_test: {X_test.shape}")
print(f"Shape of y_test: {y_test.shape}")
        </pre>

        <h2>Step 5: Model Training and Evaluation</h2>
        <h3>Linear Regression</h3>
        <pre class="code">
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score

# Initialize the model
linear_model = LinearRegression()

# Train the model
linear_model.fit(X_train_scaled, y_train)

# Make predictions
y_pred = linear_model.predict(X_test_scaled)

# Evaluate the model
mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)

print(f"Linear Regression\nMean Squared Error (MSE): {mse}\nR-squared (R2) Score: {r2}")
        </pre>

        <h3>Lasso Regression</h3>
        <pre class="code">
from sklearn.linear_model import Lasso

# Initialize the model
lasso_model = Lasso()

# Train the model
lasso_model.fit(X_train_scaled, y_train)

# Make predictions
y_pred = lasso_model.predict(X_test_scaled)

# Evaluate the model
mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)

print(f"Lasso Regression\nMean Squared Error (MSE): {mse}\nR-squared (R2) Score: {r2}")
        </pre>

        <h3>Ridge Regression</h3>
        <pre class="code">
from sklearn.linear_model import Ridge

# Initialize the model
ridge_model = Ridge()

# Train the model
ridge_model.fit(X_train_scaled, y_train)

# Make predictions
y_pred = ridge_model.predict(X_test_scaled)

# Evaluate the model
mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)

print(f"Ridge Regression\nMean Squared Error (MSE): {mse}\nR-squared (R2) Score: {r2}")
        </pre>

        <h2>Step 6: Model Comparison</h2>
        <pre class="code">
# Results from the model comparison script
print("Linear Regression:")
print("Mean Squared Error (MSE): 4.891232447128581")
print("R-squared (R2) Score: 0.5481628137889262")

print("Lasso Regression:")
print("Mean Squared Error (MSE): 7.682589007441957")
print("R-squared (R2) Score: 0.29030577927725953")

print("Ridge Regression:")
print("Mean Squared Error (MSE): 4.8910568846413325")
print("R-squared (R2) Score: 0.5481790317178632")
        </pre>

        <div class="results">
            <h2>Results and Conclusion</h2>
            <p>The performance of the three regression models on the abalone dataset is summarized below:</p>
            <ul>
                <li><strong>Linear Regression:</strong> MSE = 4.8912, R2 = 0.5482</li>
                <li><strong>Lasso Regression:</strong> MSE = 5.3656, R2 = 0.5043</li>
                <li><strong>Ridge Regression:</strong> MSE = 4.8911, R2 = 0.5482</li>
            </ul>
            <p>Based on the evaluation metrics, both Linear Regression and Ridge Regression perform similarly and better than Lasso Regression. Ridge Regression is particularly useful if there is multicollinearity in the features.</p>
        </div>

        <div class="images">
            <!-- Placeholder for images -->
            <!-- <img src="path_to_image1.jpg" alt="Image description 1">
            <img src="path_to_image2.jpg" alt="Image description 2"> -->
        </div>
    </div>
    <footer>
        <p>&copy; 2024 Abalone Age Prediction Project</p>
    </footer>
</body>
</html>
